<!-- 状态栏区域 -->
<view class="cu-custom" style="height:{{CustomBar}}px;">
    <view class="cu-bar fixed none-bg text-white bg-img" style="height:{{CustomBar}}px;padding-top:{{StatusBar}}px;">
        <navigator class='action canui-head-title' open-type="navigateBack" hover-class="none">
            <text class='icon-back'></text>
            我的订单
        </navigator>
    </view>
</view>
<view class="box" style="top: {{CustomBar}}px;">
    <scroll-view scroll-x class="bg-white nav">
        <view class='flex text-center'>
            <view class="cu-item flex-sub {{item.id==TabCur?'text-red cur':''}}" wx:for="{{SortMenu}}" wx:key="item.id" bindtap='tabSelect' data-id="{{item.id}}">
                {{item.name}}
            </view>
        </view>
    </scroll-view>
    <view class="canui-order-item bg-white shadow-sm radius margin-bottom" wx:for="{{ orderList }}" wx:if="{{ TabCur == 0 || TabCur == 2 || TabCur == 1 }}">
        <view class="head-title-box padding solid-bottom">
            <text class="icon-shop text-lg text-blue"></text>
            <text class="text-bold margin-left-xs">{{ item.scenicName }}</text>
            <text class="icon-right text-gray"></text>
            <text class="text-right text-{{ item.orderStatus == 0 ? 'red' : 'green' }} canui-text-right text-sm">
                {{ item.orderStatus == 1 ? '待使用' : '已使用' }}
            </text>
        </view>
        <navigator open-type="navigate" hover-class='none' style="padding: 10px 20px">
            <view class="cu-list menu menu-avatar">
                <view class="cu-item">
                    <view class="cu-avatar radius lg" style="background-image:url({{ item.webImg }});"></view>
                    <view class='content canui-xzwz tow padding-left-sm'>
                        <view class="text-gray text-sm margin-top-xs">{{ item.area }}</view>
                        <view>
                            {{ item.level }}
                        </view>
                    </view>
                    <view class='action padding-left-sm text-right'>
                        <view class='text-price text-xl text-bold'>¥{{ item.scenicPrice }}</view>
                        <view class="text-xs text-gray margin-top-xs">x{{ item.amount }}</view>
                    </view>
                </view>
            </view>
        </navigator>
        <view class="order-price-box padding solid-top flex justify-between align-center">
            <view class="text-gray text-sm">
                共{{ item.amount }}张
            </view>
            <view class="text-right">
                合计：<text class="text-price text-bold text-lg">¥{{ item.scenicPrice * item.amount }}</text>
            </view>
        </view>
        <view class="grid col-4 flex justify-end order-btn-box padding solid-top">
            <text wx:if="{{ item.evaluationStatus != null }}" class="text-right text-orange text-sm self-center">
                {{ item.evaluationContent }}
            </text>
            <view class='margin-left-sm' wx:if="{{ item.orderStatus == 1}}">
                <button class='cu-btn round line-red shadow sm' bindtap="chargebacks">
                    <text class="icon-refund"></text>
                    退 单
                </button>
            </view>
            <view class='margin-left-sm' wx:if="{{ item.evaluationStatus == null && item.orderStatus == 2}}">
                <button class='cu-btn round line-blue shadow sm' bindtap="evaluation">
                    评 价
                </button>
            </view>
        </view>
        <view wx:if="{{ orderList.length === 0 }}">
            <van-empty style="height: 400px;margin: 0 auto" description="无订单信息" />
        </view>
    </view>
    <van-popup show="{{ show }}" position="bottom" custom-style="height: 35%;" bind:close="onClose">
        <view style="font-size: 15px;margin-left: 22px;margin-top: 10px;display: block;">订单评价</view>
        <view style="padding: 20px;display: block">
            <van-field model:value="{{ remarks }}" label="评价" placeholder="请输入评价" style="display: block;margin-top: 15px;" />
            <van-button type="primary" block style="display: block;margin-top: 15px;" bindtap="evaluationSubmit">
                提 交
            </van-button>
        </view>
    </van-popup>
</view>
